---
- name: Archive files
  become: true
  community.general.archive:
    path: "{{ item }}"
    exclusion_patterns:
      - '**/*tar.gz'
      - '**/*tgz'
      - '**/*deb'
      - '**/*zip'
      - '**/*vagrant*'
      - '**/*VirtualBox*'
    dest: '{{ backup_dir }}/{{ item.rsplit('/')[-1] }}-{{ archive_tag }}.tgz'
    loop: ' {{ backup_targets }}'

